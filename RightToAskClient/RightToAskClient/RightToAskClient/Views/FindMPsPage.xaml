<?xml version="1.0" encoding="utf-8"?>

<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:xct="http://xamarin.com/schemas/2020/toolkit"
             xmlns:local="clr-namespace:RightToAskClient"
             xmlns:vm="clr-namespace:RightToAskClient.ViewModels;assembly=RightToAskClient"
             xmlns:helpers="clr-namespace:RightToAskClient.Helpers;assembly=RightToAskClient"
             x:Class="RightToAskClient.Views.RegisterPage2"
             Title="Find your MPs"
             x:DataType="vm:FindMPsViewModel">
    <ContentPage.ToolbarItems>
        <ToolbarItem Text="{xct:Translate HomeButtonText}" Command="{Binding HomeButtonCommand}" x:DataType="vm:BaseViewModel"
                     IconImageSource="{helpers:ImageResource RightToAskClient.Images.home4.png}"/>
        <ToolbarItem Text="{xct:Translate InfoPopupButtonText}" Command="{Binding InfoPopupCommand}" x:DataType="vm:BaseViewModel" 
                     IconImageSource="{helpers:ImageResource RightToAskClient.Images.help_75.png}"/>
    </ContentPage.ToolbarItems>
    <ContentPage.BindingContext>
        <vm:FindMPsViewModel/>
    </ContentPage.BindingContext>
        <ContentPage.Content>
	    <ScrollView Margin="0" Padding="0">
            <StackLayout Orientation="Vertical" VerticalOptions="FillAndExpand" Spacing="0">
                <!--<ActivityIndicator IsRunning="{Binding IsBusy}" IsVisible="{Binding IsBusy}"/>-->
                <!--Label Choice Option Frames-->
                <Label Text="{xct:Translate MPsHeaderText1}" Style="{StaticResource Header1}" HorizontalTextAlignment="Center" Margin="0,10,0,0"/>
                <BoxView />
                <Grid ColumnDefinitions="*,*,*" Margin="0,10,0,0">
                    <Button Grid.Column="0" Text="{xct:Translate ElectoratesKnownHeaderText}" Style="{StaticResource GreenButton}" Command="{Binding KnowElectoratesCommand}" HorizontalOptions="End"/>
                    <Label Grid.Column="1" Text="Or" WidthRequest="25" FontSize="Large"
					       HorizontalOptions="Center" VerticalOptions="Center" />
                    <Button Grid.Column="2" Text="Look Up" Style="{StaticResource GreenButton}" Command="{Binding LookupElectoratesCommand}" HorizontalOptions="Start"/>
                </Grid>
                <!--Map Display-->
                <Frame Margin="0" Padding="0" IsVisible="{Binding ShowMapFrame}" WidthRequest="150">
                    <StackLayout Margin="0" Padding="0">
                        <!--Webview has default padding in its underlying html that is proving difficult to remove-->
                        <WebView Source="{Binding MapURL}" WidthRequest="300" HeightRequest="250" Margin="0"/>
                    </StackLayout>
                </Frame>
                <!--Known Electorates Section-->
                <Frame Style="{StaticResource SubtleFrame}" IsVisible="{Binding ShowKnowElectoratesFrame}">
                    <Grid ColumnDefinitions="*,*" Margin="10" RowSpacing="10">
                        <!--State Selector/Picker-->
                            <Label Grid.Row="0" Grid.Column="0" Text="{xct:Translate ChooseStateOrTerritory}" HorizontalOptions="Start" HorizontalTextAlignment="Start" VerticalOptions="Center" Style="{StaticResource PaleButtonText}" />
                            <Picker  Grid.Row="0" Grid.Column="1" Title="{Binding StatePickerTitle}" ItemsSource="{Binding StatePicker}" 
					            Style="{StaticResource CenterFramePicker}" HorizontalOptions="FillAndExpand" SelectedIndex="{Binding SelectedStateAsInt}" />
                        <Label Grid.Row="1" Grid.Column="0" Text="{xct:Translate FederalElectoratePickerTitle}" HorizontalTextAlignment="Start" VerticalOptions="Center" Style="{StaticResource PaleButtonText}" />
                            <Picker Grid.Row="1" Grid.Column="1" Margin="0" Style="{StaticResource CenterFramePicker}" IsVisible="{Binding ShowStateOnly, Converter={StaticResource Key=cnvInvert}}" Title="{Binding FederalElectoratePickerTitle}" ItemsSource="{Binding FederalElectorates}"
                                SelectedIndex="{Binding SelectedFederalElectorate}" MinimumWidthRequest="200" HorizontalOptions="Fill" HorizontalTextAlignment="Start" />
                        <!-- Everywhere but Tasmania, the electorate you choose is your Legislative Assembly Electorate. In Tas, it's your Legislative Council Electorate.
                                Along with your House of Representatives electorate, this is enough to infer all your other electorates. -->
                            <Label Grid.Row="2" Grid.Column="0" Text="{Binding StateChoosableElectorateHeader}" HorizontalTextAlignment="Start" Style="{StaticResource PaleButtonText}"/>
                            <Picker Grid.Row="2" Grid.Column="1" Margin="0" Style="{StaticResource CenterFramePicker}" HorizontalOptions="Fill" ItemsSource="{Binding AllStateChoosableElectorates}" 
                                    Title="{Binding StateChoosableElectorate}" SelectedIndex="{Binding SelectedStateElectorateIndex}" />
                        <Label  Grid.Row="3" Grid.Column="0" Text="{Binding StateInferredElectorateHeader}" Style="{StaticResource PaleButtonText}" HorizontalTextAlignment="Start" />
                        <Label  Grid.Row="3" Grid.Column="1" Text="{Binding StateInferredElectorate}" Style="{StaticResource PaleButtonText}" HorizontalTextAlignment="Start" />
                    </Grid>
                </Frame>
                <!--Address Lookup Stack-->
                <Frame Style="{StaticResource SubtleFrame}" IsVisible="{Binding ShowAddressStack}">
                    <StackLayout Margin="2" Spacing="0">
                        <!--State Selector/Picker-->
                        <StackLayout Orientation="Horizontal" HorizontalOptions="Start" Margin="0" Padding="0">
                            <Label Text="{xct:Translate ChooseStateOrTerritory}" HorizontalTextAlignment="Start" VerticalOptions="Center" Style="{StaticResource PaleButtonText}" />
                            <Picker Title="{Binding StatePickerTitle}" ItemsSource="{Binding StatePicker}" 
					        Style="{StaticResource CenterFramePicker}" SelectedIndex="{Binding SelectedStateAsInt}" />
                        </StackLayout>
                        <StackLayout Margin="0" Padding="0" Spacing="0">
                            <Label Text="{xct:Translate StreetHeaderText}" Style="{StaticResource LeftFrameText}" Margin="0" Padding="0"/>
                            <Entry Placeholder="{xct:Translate StreetHeaderText}" Text="{Binding Address.StreetNumberAndName}" Style="{StaticResource LeftFrameEntry}" Margin="0"/>
                            <Label Text="{xct:Translate CitySuburbHeaderText}" Style="{StaticResource LeftFrameText}" Margin="0" Padding="0"/>
                            <Entry Placeholder="{xct:Translate CitySuburbHeaderText}" Text="{Binding Address.CityOrSuburb}" Style="{StaticResource LeftFrameEntry}"/>
                            <Label Text="{xct:Translate PostcodeHeaderText}" Style="{StaticResource LeftFrameText}" Margin="0" Padding="0"/>
                            <Grid ColumnDefinitions="*,*">
                                <Entry Grid.Column="0" Placeholder="{xct:Translate PostcodeHeaderText}" Text="{Binding Address.Postcode}" Style="{StaticResource LeftFrameEntry}"/>
                                <Button Grid.Column="1" Text="{xct:Translate LocateButtonText}" Style="{StaticResource GreenButton}" Command="{Binding SubmitAddressButtonCommand}"/>
                            </Grid>
                        </StackLayout>
                    </StackLayout>
                </Frame>
                <!--Done Button-->
                <StackLayout Orientation="Horizontal" HorizontalOptions="EndAndExpand">
                    <Button Style="{StaticResource GreenButton}" Text="{xct:Translate SkipStepButton}" Command="{Binding SkipButtonCommand}" IsVisible="{Binding ShowSkipButton}"/>
                    <Button HorizontalOptions="End" Style="{StaticResource DoneButton}" Text="{xct:Translate SaveButtonText}" Command="{Binding SaveMPsButtonCommand}" IsVisible="{Binding ShowFindMPsButton}" />
                </StackLayout>
            </StackLayout>
        </ScrollView>
    </ContentPage.Content>
</ContentPage>